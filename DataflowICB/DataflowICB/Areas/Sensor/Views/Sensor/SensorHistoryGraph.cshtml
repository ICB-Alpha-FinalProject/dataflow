@model string

<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
<script src="https://www.amcharts.com/lib/3/serial.js"></script>
<script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
<script src="https://www.amcharts.com/lib/3/themes/light.js"></script>

<div id="chartdiv"></div>

@section scripts{
    <script type="text/javascript">
        var chart;
         $.ajax({
             url: "@Url.Action("GetHistoryDataForSensor", "Sensor", new {area = "Sensor", sensorId = "6" })",
             dataType: "JSON",
             complete: function (chartData) {
                 chartData = JSON.parse(chartData.responseJSON);
                 console.log("chart ", chartData);
                 chart = AmCharts.makeChart("chartdiv", {
                     "type": "serial",
                     "theme": "light",
                     "marginRight": 80,
                     "dataProvider": chartData,
                     "valueAxes": [{
                         "position": "left",
                         "title": "Value"
                     }],
                     "graphs": [{
                         "id": "g1",
                         "fillAlphas": 0.4,
                         "valueField": "Value",
                         "balloonText": "<div style='margin:5px; font-size:19px;'>Value:<b>[[value]]</b></div>"
                     }],
                     "chartScrollbar": {
                         "graph": "g1",
                         "scrollbarHeight": 80,
                         "backgroundAlpha": 0,
                         "selectedBackgroundAlpha": 0.1,
                         "selectedBackgroundColor": "#888888",
                         "graphFillAlpha": 0,
                         "graphLineAlpha": 0.5,
                         "selectedGraphFillAlpha": 0,
                         "selectedGraphLineAlpha": 1,
                         "autoGridCount": true,
                         "color": "#AAAAAA"
                     },
                     "chartCursor": {
                         "categoryBalloonDateFormat": "YYYY-MM-DD HH:NN:SS",
                         "cursorPosition": "mouse"
                     },
                     "categoryField": "timeStamp",
                     "categoryAxis": {
                         "minPeriod": "ss",
                         "parseDates": true
                     },
                     "export": {
                         "enabled": true,
                         "dateFormat": "YYYY-MM-DD HH:NN:SS"
                     }
                 });

                 chart.addListener("dataUpdated", zoomChart);
                 // when we apply theme, the dataUpdated event is fired even before we add listener, so
                 // we need to call zoomChart here
                 zoomChart();
                 // this method is called when chart is first inited as we listen for "dataUpdated" event
                 function zoomChart() {
                     // different zoom methods can be used - zoomToIndexes, zoomToDates, zoomToCategoryValues
                     chart.zoomToIndexes(chartData.length - 250, chartData.length - 100);
                 }
             }
         })
    </script>

}